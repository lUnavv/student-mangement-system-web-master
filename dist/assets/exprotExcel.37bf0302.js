import{E as g}from"./exceljs.8ca1ad7e.js";const h=(e,t=10)=>{e==null?t=10:e.toString().charCodeAt(0)>255?t=e.toString().length*2:t=e.toString().length},p=async({column:e,data:t,filename:r,autoWidth:b,format:c})=>{console.log("data----------:",t);const n=new g.Workbook;n.creator="Me",n.title=r,n.created=new Date,n.modified=new Date;const s=n.addWorksheet(r),a=[];console.log("column----------:",e);for(let o in e)console.log("item----------:",o);e.forEach((o,k)=>{const i={header:o.label,key:o.name,width:null};if(b){const w=[h(o.label)];t.forEach(x=>{const d=x[o.name]||"";d&&w.push(h(d))}),i.width=Math.max(...w)+5}a.push(i)}),s.columns=a,s.addRows(t);const f=c==="xlsx"?await n.xlsx.writeBuffer():await n.csv.writeBuffer(),l=new Blob([f],{type:"application/octet-binary"});if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(l,r+`.${c}`);else{const o=document.createElement("a");o.href=window.URL.createObjectURL(l),o.download=r+`.${c}`,o.click(),window.URL.revokeObjectURL(o.href)}};export{p as e};
